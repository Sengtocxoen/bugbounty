# Bug Bounty Scanner - Example Configuration
# Copy this file and customize for your scans

# =============================================================================
# SCAN MODE - Which tool to use
# =============================================================================

# Options: deep, fullrecon, intelligent, continuous, recon, discover, parallel
# Leave commented out to be prompted interactively
# scan_mode: "deep"

# =============================================================================
# PROGRAM & USER INFO
# =============================================================================

# Program name: "amazon", "shopify", "anduril", or null for generic
program: amazon

# Your HackerOne username (required for some programs)
h1_username: "sengtocxoen"

# =============================================================================
# TARGETS
# =============================================================================

# List your target domains here
targets:
  - "amazon.com"
  # - "app.example.com"
  # - "api.example.com"

# =============================================================================
# CUSTOM HEADERS
# =============================================================================

# Add any required HTTP headers
custom_headers: {}
  # X-HackerOne-Research: "your_username"  # Anduril requires this
  # X-Bug-Bounty: "researcher"

# =============================================================================
# RATE LIMITING
# =============================================================================

# Amazon VRP requires MAX 5 requests/second - we use 4.5 for safety margin
rate_limit: 4.5             # Requests per second (CRITICAL: max 5 req/s)
request_delay: 0.22         # 220ms delay between requests
request_timeout: 30         # Request timeout (seconds)

# =============================================================================
# SCAN PHASES
# =============================================================================

phases:
  subdomain_discovery: true    # Find subdomains
  port_scanning: true          # Scan ports
  endpoint_discovery: true     # Find endpoints
  tech_detection: true         # Detect technologies
  js_analysis: true            # Analyze JavaScript
  param_fuzzing: true          # Test for vulnerabilities
  verification: true           # Verify findings

# =============================================================================
# ADVANCED FEATURES (NEW!)
# =============================================================================

advanced_features:
  # Response Deduplication - Skip similar pages (60% faster scans)
  response_dedup:
    enabled: true
    similarity_threshold: 0.85   # 85% similarity = duplicate (0.0-1.0)
  
  # Secret Validation - Verify credentials are active (90% less false positives)  
  secret_validation:
    enabled: true
    validate_aws: true           # Test AWS keys via STS
    validate_firebase: true      # Test Firebase URLs
    validate_github: true        # Test GitHub tokens
    validate_google: true        # Test Google API keys
    validate_slack: true         # Test Slack tokens
  
  # GitHub/GitLab Dorking - Search repos for leaks
  github_dorking:
    enabled: false               # Enable to search public repos
    github_token: null           # Optional: GitHub PAT for higher rate limits
    gitlab_token: null           # Optional: GitLab token
    max_results: 50
  
  # GraphQL Introspection - Map GraphQL schemas
  graphql:
    enabled: true
    auto_detect: true            # Auto-detect GraphQL endpoints
    introspect_authenticated: false  # Try introspection with auth headers
  
  # Advanced Fuzzing - Recursive directory discovery
  fuzzing:
    recursive: true              # Recurse into found directories
    max_depth: 3                 # Max recursion depth
    header_fuzz: true            # Try header injection bypasses
    soft_404_detection: true     # Smart soft-404 filtering
    wordlist: "wordlists/common.txt"
  
  # Vulnerability Chaining - Auto-escalate severity
  vuln_chaining:
    enabled: true
    auto_escalate: true          # Auto-trigger deep scans on findings
    chain_ssrf_idor: true        # Chain SSRF + IDOR
    chain_xss_csrf: true         # Chain XSS + CSRF
    chain_lfi_rce: true          # Chain LFI + RCE
  
  # Enhanced WAF Evasion
  waf_evasion:
    proxy_rotation: false        # Enable proxy rotation
    proxy_list: []               # List of proxy URLs
    tamper_payloads: true        # SQLMap-style tampering
    adaptive_delay: true         # Auto-adjust on rate limits

# =============================================================================
# LIMITS (0 = unlimited)
# =============================================================================

limits:
  max_subdomains: 0
  max_endpoints: 0
  max_js_files: 0
  max_fuzz_urls: 0

# =============================================================================
# PORT SCANNING
# =============================================================================

port_scan:
  full_scan: true              # Scan all common ports
  custom_ports: []             # Add specific ports: [8080, 8443]

# =============================================================================
# VERIFICATION
# =============================================================================

verification:
  threads: 10                  # Concurrent verification threads
  verify_only_high_priority: false
  test_default_credentials: false  # DO NOT enable unless authorized

# =============================================================================
# NUCLEI VULNERABILITY SCANNING
# =============================================================================

nuclei_scan:
  enabled: true                # Enable/disable Nuclei scanning
  
  # Severity levels to scan for
  severity:
    - critical
    - high
    - medium
    # - low
    # - info
  
  # Tags to include (leave empty for all)
  tags: []
    # - cve
    # - exposure
    # - misconfig
    # - tech
  
  # Tags to exclude
  exclude_tags:
    - dos                      # Exclude DoS tests
  
  # Path to custom Nuclei templates (optional)
  custom_templates: null       # Example: "custom_templates/"
  
  # What targets to scan
  scan_targets:
    subdomains: true           # Scan discovered live subdomains
    endpoints: true            # Scan discovered endpoints
    cloud_buckets: false       # Scan cloud bucket URLs (may cause access issues)
    ports: true                # Scan web services on open ports
  
  # Performance settings
  rate_limit: 150              # Requests per minute
  timeout: 300                 # Timeout per target (seconds)
  threads: 10                  # Concurrent threads
  
  # Template updates
  update_templates: false      # Update Nuclei templates before scan (adds time)

# =============================================================================
# OUTPUT
# =============================================================================

output:
  directory: "results"         # Output directory
  save_json: true
  save_txt: true
  save_html: false
  verbose: true

# =============================================================================
# SAFETY
# =============================================================================

safety:
  confirm_before_run: true     # Ask for confirmation
  show_review: true            # Show full review before running
  max_threads: 10

# =============================================================================
# NOTES
# =============================================================================

notes: |
  Bug bounty scan configuration - Maximum Capabilities Edition
  - Edit targets, headers, and phases as needed
  - Enable advanced_features for maximum bug discovery
  - Secret validation reduces false positives by 90%
  - Response dedup speeds up scans by 60%
  - Vulnerability chaining auto-escalates severity
  - Nuclei scanning automatically runs on discovered targets
  - Review configuration before running
  - Follow program rules and scope
