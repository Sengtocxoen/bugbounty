# Bug Bounty Scanner - DoorDash Maximum Scan Configuration
# Target: DoorDash Bug Bounty Program
# Configuration Date: 2026-02-05

# =============================================================================
# PROGRAM & USER INFO
# =============================================================================

# Program name
program: "doordash"

# Your HackerOne username (REQUIRED for DoorDash - used in X-Bug-Bounty header)
h1_username: "your_h1_username"  # REPLACE WITH YOUR HACKERONE USERNAME

# =============================================================================
# TARGETS
# =============================================================================

# DoorDash IN-SCOPE targets (eligible_for_bounty: true)
# Last updated from scopes CSV: 2026-02-05
targets:
  - "www.doordash.com"  # Primary web interface
  # Mobile apps (testing via web interfaces and APIs)
  # - com.dd.doordash (Consumer Android)
  # - doordash.DoorDashConsumer (Consumer iOS)
  # Add discovered subdomains as needed (verify eligibility first)

# =============================================================================
# CUSTOM HEADERS
# =============================================================================

# DoorDash REQUIRES this header for all security testing
custom_headers:
  X-Bug-Bounty: "your_h1_username"  # REPLACE WITH YOUR HACKERONE USERNAME

# =============================================================================
# RATE LIMITING
# =============================================================================

# Conservative rate limiting to avoid disruption (as per DoorDash rules)
rate_limit: 3              # Requests per second (conservative)
request_delay: 0.4         # Delay between requests (seconds)
request_timeout: 30        # Request timeout (seconds)

# =============================================================================
# SCAN PHASES
# =============================================================================

phases:
  subdomain_discovery: true    # Find subdomains
  port_scanning: true          # Scan ports (follow program rules)
  endpoint_discovery: true     # Find endpoints
  tech_detection: true         # Detect technologies (React.js, Python/Django, Kotlin, Go, Java)
  js_analysis: true            # Analyze JavaScript (React.js components)
  param_fuzzing: true          # Test for vulnerabilities
  verification: true           # Verify findings

# =============================================================================
# ADVANCED FEATURES - ALL ENABLED FOR MAXIMUM COVERAGE
# =============================================================================

advanced_features:
  # Response Deduplication - Skip similar pages (60% faster scans)
  response_dedup:
    enabled: true
    similarity_threshold: 0.85   # 85% similarity = duplicate (0.0-1.0)
  
  # Secret Validation - Verify credentials are active (90% less false positives)  
  secret_validation:
    enabled: true
    validate_aws: true           # Test AWS keys via STS
    validate_firebase: true      # Test Firebase URLs
    validate_github: true        # Test GitHub tokens
    validate_google: true        # Test Google API keys
    validate_slack: true         # Test Slack tokens
  
  # GitHub/GitLab Dorking - Search repos for leaks
  github_dorking:
    enabled: true                # Search for DoorDash credentials/secrets
    github_token: null           # Optional: GitHub PAT for higher rate limits
    gitlab_token: null           # Optional: GitLab token
    max_results: 100             # Maximum search results
  
  # GraphQL Introspection - Map GraphQL schemas
  graphql:
    enabled: true
    auto_detect: true            # Auto-detect GraphQL endpoints
    introspect_authenticated: true  # Try introspection with auth headers
  
  # Advanced Fuzzing - Recursive directory discovery
  fuzzing:
    recursive: true              # Recurse into found directories
    max_depth: 4                 # Max recursion depth
    header_fuzz: true            # Try header injection bypasses
    soft_404_detection: true     # Smart soft-404 filtering
    wordlist: "wordlists/common.txt"
  
  # Vulnerability Chaining - Auto-escalate severity
  vuln_chaining:
    enabled: true
    auto_escalate: true          # Auto-trigger deep scans on findings
    chain_ssrf_idor: true        # Chain SSRF + IDOR
    chain_xss_csrf: true         # Chain XSS + CSRF
    chain_lfi_rce: true          # Chain LFI + RCE
  
  # Enhanced WAF Evasion
  waf_evasion:
    proxy_rotation: false        # Disable to avoid attribution issues
    proxy_list: []               # Keep empty for direct testing
    tamper_payloads: true        # SQLMap-style tampering
    adaptive_delay: true         # Auto-adjust on rate limits

# =============================================================================
# LIMITS - UNLIMITED FOR MAXIMUM COVERAGE
# =============================================================================

limits:
  max_subdomains: 0              # No limit
  max_endpoints: 0               # No limit
  max_js_files: 0                # No limit (important for React.js analysis)
  max_fuzz_urls: 0               # No limit

# =============================================================================
# PORT SCANNING
# =============================================================================

port_scan:
  full_scan: true                # Scan all common ports
  custom_ports:                  # Common web service ports
    - 8080
    - 8443
    - 3000
    - 4000
    - 5000
    - 8000
    - 8888

# =============================================================================
# VERIFICATION
# =============================================================================

verification:
  threads: 15                    # Concurrent verification threads
  verify_only_high_priority: false  # Verify all findings
  test_default_credentials: false   # DISABLED per DoorDash rules (no brute forcing)

# =============================================================================
# OUTPUT
# =============================================================================

output:
  directory: "results/doordash"  # Output directory specific to DoorDash
  save_json: true
  save_txt: true
  save_html: true                # Enable HTML reports for easier review
  verbose: true

# =============================================================================
# SAFETY
# =============================================================================

safety:
  confirm_before_run: true       # Ask for confirmation
  show_review: true              # Show full review before running
  max_threads: 15                # Maximum concurrent threads

# =============================================================================
# DOORDASH-SPECIFIC SCOPE & RESTRICTIONS
# =============================================================================

scope:
  # IN-SCOPE ASSETS (eligible_for_bounty: true)
  in_scope:
    web:
      - "www.doordash.com"  # Primary consumer web interface
    mobile:
      - "com.dd.doordash"  # Consumer Android app
      - "doordash.DoorDashConsumer"  # Consumer iOS app
  
  # OUT-OF-SCOPE ASSETS (eligible_for_bounty: false)
  out_of_scope:
    wildcards:
      - "*.dashapi.com"  # Internal API domains
      - "*.doorcrawl.com"  # Crawler infrastructure
      - "*.order.online"  # Third-party domains
      - "doordash.com/unified-gateway/*"  # Gateway endpoints
      - "doordash.com/orders/drive/*"  # Drive-specific endpoints
    urls:
      - "help.doordash.com"  # Help/support site
      - "careersatdoordash.com"  # Careers site
      - "ir.doordash.com"  # Investor relations
      - "unified-gateway.doordash.com"  # Gateway
      - "consumer-mobile-bff.doordash.com"  # BFF endpoints
      - "merchant-mobile-bff.doordash.com"  # BFF endpoints
      - "merchant-portal.doordash.com"  # Internal merchant portal
      - "doordash.com/merchant"  # Merchant interface
      - "track.doordash.com"  # Tracking interface
      - "internal.doordash.com"  # Internal systems
    other:
      - "DoorDash Payments"  # Payment processing systems
  
  # Focus on high-priority vulnerability types per DoorDash program
  priority_vulnerabilities:
    - "Authentication & Authorization"
    - "Code Execution & Injection"
    - "Platform & Infrastructure Security"
  
  # Excluded vulnerability types (as per DoorDash program rules)
  excluded_vulnerabilities:
    - "RBAC without risk"
    - "Leaked credentials from external sources"
    - "Information disclosure without exploitability"
    - "Open redirects without escalation"
    - "Missing security headers without exploit"
    - "Self-XSS / Self-DoS"
    - "CSRF/Clickjacking on non-critical functions"
    - "Low-impact mobile findings"
    - "Rate limiting without impact"
  
  # Testing restrictions
  restrictions:
    no_disruption: true          # Do not disrupt service
    no_data_destruction: true    # Do not destroy data
    no_brute_force: true         # No credential brute forcing
    no_dos_attacks: true         # No DoS testing
    no_user_privacy: true        # Do not access other users' data
    no_public_disclosure: true   # No public disclosure
    no_automated_scanners: true  # No automated scanners (run manual verification)
    no_pivoting: true            # Report immediately, don't extend
    no_stockpiling: true         # Report all variants at once
    no_aws_writes: true          # No AWS API changes that write/create/delete
    no_third_party: true         # Third-party systems out of scope
  
  # Technology stack (for targeted testing)
  tech_stack:
    backend:
      - "Python/Django (legacy monolith)"
      - "Kotlin"
      - "Go"
      - "Java"
      - "Microservices architecture"
    frontend:
      - "React.js"
      - "HTML"
    mobile:
      - "iOS"
      - "Android"
    cloud:
      - "AWS"

# =============================================================================
# NOTES
# =============================================================================

notes: |
  DoorDash Bug Bounty Program - Maximum Coverage Scan Configuration
  
  CRITICAL REQUIREMENTS:
  - MUST use X-Bug-Bounty header with your HackerOne username
  - Create account with @wearehackerone.com email
  - Use plus addressing for multiple accounts: username+1@wearehackerone.com
  - NO disruptive testing (no DoS, no brute force, no data destruction)
  - NO automated scanners (this is a MANUAL verification tool)
  - Respect user privacy - stop when you have proof, don't access user data
  - Report findings immediately - no pivoting or extending
  - Same vulnerability on multiple domains = ONE report (shared codebase)
  
  PRIORITY FOCUS AREAS:
  1. Authentication & Authorization bypasses, account takeovers, session hijacking
  2. Code Execution & Injection (RCE, SQLi, NoSQLi, XSS, command injection)
  3. Platform Security (exposed credentials, API keys, secrets in repos)
  
  TECHNOLOGY STACK:
  - Microservices (Kotlin, Go, Java) evolved from Python/Django monolith
  - React.js front-end with HTML
  - iOS/Android mobile apps
  - AWS infrastructure
  
  EXCLUSIONS:
  - RBAC restrictions without security risk
  - External credential leaks (unless from DoorDash systems)
  - Info disclosure without exploitability
  - Open redirects without escalation potential
  - Missing headers without demonstrable exploit
  - Self-XSS/Self-DoS
  - CSRF/Clickjacking on non-critical functions
  - Low-impact mobile findings
  - Rate limiting without impact
  
  TESTING ACCOUNT:
  - Sign up at https://www.doordash.com/
  - Use your @wearehackerone.com email
  - Use plus addressing for multiple test accounts
  
  ADVANCED FEATURES ENABLED:
  - Response deduplication (60% faster)
  - Secret validation (90% less false positives)
  - GitHub dorking for exposed secrets
  - GraphQL introspection
  - Recursive fuzzing (depth: 4)
  - Vulnerability chaining for escalation
  - WAF evasion techniques
  
  Before running:
  1. Replace "your_h1_username" with your actual HackerOne username
  2. Review DoorDash program rules
  3. Confirm configuration aligns with scope
  4. Ensure testing account is set up
  5. Run with confirmation enabled
  
  Target Directory: F:\work\BugBounty\Target\DoorDash
